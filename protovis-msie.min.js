pv.have_SVG=!(!document.createElementNS||!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect);pv.have_VML=function(f,k,n){k=f.createElement("div");k.innerHTML='<v:shape adj="1" />';n=k.firstChild;n.style.behavior="url(#default#VML)";return n?"object"===typeof n.adj:!0}(document);Array.prototype.indexOf||(Array.prototype.indexOf=function(f,k){for(var n=this.length>>>0,o=!isFinite(k)||0>k?0:k>this.length?this.length:k;o<n;o++)if(this[o]===f)return o;return-1});
!pv.have_SVG&&pv.have_VML&&function(){if(typeof Date.now!=="function")Date.now=function(){return new Date*1};var f={round:function(a){return Math.round(a*21.6)},styles:null,pre:"<v:",post:' class="msvml">',block:{group:1,shape:1,shapetype:1,line:1,polyline:1,curve:1,rect:1,roundrect:1,oval:1,arc:1,image:1},ends:{butt:"flat",round:"round",square:"square",flat:"flat"},joins:{bevel:"bevel",round:"round",miter:"miter"},cursorstyles:{hand:"pointer",crosshair:1,pointer:1,move:1,text:1,wait:1,help:1,progress:1,
"n-resize":1,"ne-resize":1,"nw-resize":1,"s-resize":1,"se-resize":1,"sw-resize":1,"e-resize":1,"w-resize":1},text_shim:null,_textcache:{},text_dims:function(a,b){b in f._textcache||(f._textcache[b]={});if(a in f._textcache[b])return f._textcache[b][a];var c=f.text_shim;c.style.font=b;c.innerText=a;return f._textcache[b][a]={fontsize:parseInt(c.style.fontSize,10),height:c.offsetHeight,width:c.offsetWidth}},d2r:Math.PI*2/360,get_dim:function(a,b){var c=b||{};c.translate_x=0;c.translate_y=0;if(a.transform){var d=
/translate\((\d+(?:\.\d+)?)(?:,(\d+(?:\.\d+)?))?\)/.exec(a.transform);if(d&&d[1])c.translate_x=parseFloat(d[1]);if(d&&d[2])c.translate_y=parseFloat(d[2]);if(d=/rotate\((\-?\d+\.\d+|\-?\d+)\)/.exec(a.transform))c.rotation=parseFloat(d[1])%360}c.x=parseFloat(a.x||0);c.y=parseFloat(a.y||0);if("width"in a)c.width=parseInt(a.width,10);if("height"in a)c.height=parseInt(a.height,10);return c},elm_defaults:{g:{rewrite:"span",attr:function(a,b,c){a=f.get_dim(a);c.style.cssText="position:absolute;zoom:1;left:"+
(a.translate_x+a.x)+"px;top:"+(a.translate_y+a.y)+"px;"}},line:{rewrite:"shape",attr:function(a,b,c){var b=parseFloat(a.x1||0),d=parseFloat(a.y1||0),e=parseFloat(a.x2||0),i=parseFloat(a.y2||0),h=f.round;c.coordorigin="0,0";c.coordsize="21600,21600";f.path(c).v="M "+h(b)+" "+h(d)+" L "+h(e)+" "+h(i)+" E";f.stroke(c,a)},css:"top:0px;left:0px;width:1000px;height:1000px"},rect:{rewrite:"shape",attr:function(a,b,c){var d=f.get_dim(a),b=f.path(c),e=f.round;c.coordorigin="0,0";c.coordsize="21600,21600";
var i=e(d.translate_x+d.x),h=e(d.translate_y+d.y),j=e(d.width),d=e(d.height);b.v="M "+i+" "+h+" L "+(i+j)+" "+h+" L "+(i+j)+" "+(h+d)+" L "+i+" "+(h+d)+" x";f.stroke(c,a);f.fill(c,a)},css:"top:0px;left:0px;width:1000px;height:1000px"},path:{rewrite:"shape",attr:function(a,b,c){var d=f.get_dim(a),b=c.style;b.left=d.translate_x+d.x+"px";b.top=d.translate_y+d.y+"px";if(d.rotation){var e=0;d.rotation>=0&&d.rotation<=360?e=d.rotation:d.rotation<0&&d.rotation>=-360?e=360+d.rotation:d.rotation>360?e=d.rotation%
360:d.rotation<-360&&(e=360-d.rotation%360);e=e*(Math.PI*2/360);d=Math.sin(e);e=Math.cos(e);b["-ms-filter"]="progid:DXImageTransform.Microsoft.Matrix(M11="+e+", M12="+-d+", M21="+d+", M22="+e+",sizingMethod='auto expand')";b.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+e+", M12="+-d+", M21="+d+", M22="+e+",sizingMethod='auto expand')"}c.coordorigin="0,0";c.coordsize="21600,21600";f.path(c,a.d);f.fill(c,a);f.stroke(c,a)},css:"top:0px;left:0px;width:1000px;height:1000px"},circle:{rewrite:"oval",
attr:function(a,b,c){var b=f.get_dim(a),d=c.style,e=parseFloat(a.cx||0)+0.7,i=parseFloat(a.cy||0)+0.7,h=parseFloat(a.r||0)+0.5;d.top=b.translate_y+i-h+"px";d.left=b.translate_x+e-h+"px";d.width=h*2+"px";d.height=h*2+"px";f.fill(c,a);f.stroke(c,a)}},text:{rewrite:"span"},svg:{rewrite:"span",css:"position:relative;overflow:hidden;display:inline-block;~display:block;"},"vml:path":{rewrite:"path"},"vml:stroke":{rewrite:"stroke"},"vml:fill":{rewrite:"fill"}},_elmcache:{span:document.createElement("span"),
div:document.createElement("div")},createElement:function(a){var b;b=f._elmcache;var c=f.elm_defaults[a]||{},a=c.rewrite||a;if(!(a in b)){b[a]=document.createElement(f.pre+a+f.post);if(a in f.block)b[a].className=b[a].className+" msvml_block"}b=b[a].cloneNode(false);c.css&&(b.style.cssText=c.css);return b},_hex:pv.range(0,256).map(function(a){return pv.Format.pad("0",2,a.toString(16))}),_colorcache:{none:"transparent"},color:function(a,b){if(!(a in f._colorcache)&&(b=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(a)))f._colorcache[a]=
"#"+f._hex[b[1]]+f._hex[b[2]]+f._hex[b[3]];return f._colorcache[a]||a},fill:function(a,b){var c=a.getElementsByTagName("fill")[0];c||(c=a.appendChild(f.createElement("vml:fill")));if(!b.fill||b.fill==="none")c.on=false;else{c.on="true";c.color=f.color(b.fill);c.opacity=parseFloat(b["fill-opacity"]||"1")||"1"}},stroke:function(a,b){var c=a.getElementsByTagName("stroke")[0];c||(c=a.appendChild(f.createElement("vml:stroke")));if(!b.stroke||b.stroke==="none"){c.on="false";c.weight="0"}else{c.on="true";
c.weight=parseFloat(b["stroke-width"]||"1")/1.25;c.color=f.color(b.stroke)||"black";c.opacity=parseFloat(b["stroke-opacity"]||"1")||"1";c.joinstyle=f.joins[b["stroke-linejoin"]]||"miter";c.dashstyle=b["stroke-dasharray"]||""}},path:function(a,b){var c=a.getElementsByTagName("path")[0];c||(c=a.appendChild(f.createElement("vml:path")));if(arguments.length>1)c.v=f.rewritePath(b);return c},init:function(){if(!f.text_shim){f.text_shim=document.getElementById("pv_vml_text_shim")||document.createElement("span");
f.text_shim.id="protovisvml_text_shim";f.text_shim.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline-block;white-space:nowrap;";document.body.appendChild(f.text_shim)}if(!f.styles){f.styles=document.getElementById("protovisvml_styles")||document.createElement("style");if(f.styles.id!=="protovisvml_styles"){f.styles.id="protovisvml_styles";document.documentElement.firstChild.appendChild(f.styles);f.styles.styleSheet.addRule(".msvml","behavior:url(#default#VML);");
f.styles.styleSheet.addRule(".msvml_block","position:absolute;top:0;left:0;")}try{document.namespaces.v||document.namespaces.add("v","urn:schemas-microsoft-com:vml")}catch(a){f.pre="<";f.post=' class="msvml" xmlns="urn:schemas-microsoft.com:vml">'}}},_pathcache:{},rewritePath:function(a){var b=0,c=0,d=f.round;if(!a)return a;if(a in f._pathcache)return f._pathcache[a];for(var a=a.replace(/(\d*)((\.*\d*)(e ?-?\d*))/g,"$1"),e=a.match(/([MLHVCSQTAZ][^MLHVCSQTAZ]*)/gi),i=[],h=[],j=0,q=e.length;j<q;j++){var m=
e[j],l=m.charAt(0),g=m.substring(1).split(/[, ]/);switch(l){case "M":l="m";b=d(g[0]);c=d(g[1]);g=[b,c];break;case "m":l="m";b=b+d(g[0]);c=c+d(g[1]);g=[b,c];break;case "A":l="l";g=[b=d(g[5]),c=d(g[6])];break;case "L":l="l";for(j=0;j<g.length;j++)g[j]=d(g[j]);break;case "l":l="l";g=[b=b+d(g[0]),c=c+d(g[1])];break;case "H":l="l";g=[b=d(g[0]),c];break;case "h":l="l";g=[b=b+d(g[0]),c];break;case "V":l="l";g=[b,c=d(g[0])];break;case "v":l="l";g=[b,c=c+d(g[0])];break;case "C":l="c";h=g=[d(g[0]),d(g[1]),
d(g[2]),d(g[3]),b=d(g[4]),c=d(g[5])];break;case "c":l="c";h=g=[b+d(g[0]),c+d(g[1]),b+d(g[2]),c+d(g[3]),b=b+d(g[4]),c=c+d(g[5])];break;case "S":l="c";h=g=[h[4]+(h[4]-h[2]),h[5]+(h[5]-h[3]),d(g[0]),d(g[1]),b=d(g[2]),c=d(g[3])];break;case "s":l="c";h=g=[h[4]+(h[4]-h[2]),h[5]+(h[5]-h[3]),b+d(g[0]),c+d(g[1]),b=b+d(g[2]),c=c+d(g[3])];break;case "Q":var l="c",m=d(g[0]),k=d(g[1]),n=d(g[2]),g=d(g[3]),g=[~~(b+(m-b)*2/3),~~(c+(k-c)*2/3),~~(m+(n-m)/3),~~(k+(g-k)/3),b=n,c=g];break;case "q":l="l";b=b+d(g[2]);c=
c+d(g[3]);g=[b,c];break;case "Z":case "z":l="xe";g=[];break;default:l="";g=[]}i.push(l,g.join(","))}return f._pathcache[a]=i.join("")+"e"}};pv.VmlScene={scale:1,events:["mousewheel","mousedown","mouseup","mouseover","mouseout","mousemove","click","dblclick"],implicit:{css:{}},copy_functions:function(a){for(var b in a)typeof a[b]==="function"&&!(b in pv.VmlScene)&&(pv.VmlScene[b]=a[b])}};pv.VmlScene.copy_functions(pv.SvgScene);pv.Scene=pv.VmlScene;pv.VmlScene.expect=function(a,b,c,d){var d=d||{},e=
f.elm_defaults[b]||{},i=e.rewrite||b;if(a){if(a.tagName.toUpperCase()!==i.toUpperCase()){b=f.createElement(b);a.parentNode.replaceChild(b,a);a=b}}else a=f.createElement(b);"attr"in e&&e.attr(c,d,a);if(c.cursor in f.cursorstyles){e=f.cursorstyles[c.cursor];d.cursor=e===1?c.cursor:e}for(var h in d){c=d[h];c==null?a.style.removeAttribute(h):a.style[h]=c}return a};pv.VmlScene.append=function(a,b,c){a.$scene={scenes:b,index:c};a=this.title(a,b[c]);(!a.parentNode||a.parentNode.nodeType===11)&&b.$g.appendChild(a);
return a.nextSibling};pv.VmlScene.title=function(a,b){a.title=b.title||"";return a};pv.VmlScene.panel=function(a){for(var b=a.$g,c=b&&b.firstChild,d=0;d<a.length;d++){var e=a[d];if(e.visible){if(!a.parent){e.canvas.style.display="inline-block";e.canvas.style.zoom=1;if(b&&b.parentNode!=e.canvas)c=(b=e.canvas.firstChild)&&b.firstChild;if(!b){f.init();for(var b=e.canvas.appendChild(f.createElement("svg")),i=0;i<this.events.length;i++)b.addEventListener?b.addEventListener(this.events[i],this.dispatch,
false):b.attachEvent("on"+this.events[i],this.dispatch);c=b.firstChild}a.$g=b;var i=e.width+e.left+e.right,h=e.height+e.top+e.bottom;b.style.width=i+"px";b.style.height=h+"px";b.style.clip="rect(0px "+i+"px "+h+"px 0px)"}var c=this.fill(c,a,d),h=this.scale,j=e.transform,k=e.left+j.x,m=e.top+j.y;this.scale=this.scale*j.k;for(i=0;i<e.children.length;i++){e.children[i].$g=c=this.expect(c,"g",{transform:"translate("+k+","+m+")"+(j.k!=1?" scale("+j.k+")":"")});this.updateAll(e.children[i]);if(!c.parentNode||
c.parentNode.nodeType===11){b.appendChild(c);var l=f.elm_defaults[c.svgtype];if(l&&typeof l.onappend==="function")l.onappend(c,a[d])}c=c.nextSibling}this.scale=h;c=this.stroke(c,a,d)}}return c};pv.VmlScene.fill=function(a,b,c){var d=b[c],e=d.fillStyle;if(e.opacity||d.events=="all"){a=this.expect(a,"div",{},{cursor:d.cursor,left:d.left,top:d.top,width:d.width,height:d.height,border:"none",background:f.color(e.color),position:"absolute"});a=this.append(a,b,c)}return a};pv.VmlScene.stroke=function(a,
b,c){var d=b[c],e=d.strokeStyle;if(e.opacity||d.events=="all")var i=Math.round(d.lineWidth/this.scale),a=this.expect(a,"div",{},{cursor:d.cursor,left:d.left-i/2,top:d.top-i/2,width:Math.max(1E-10,d.width)-i,height:Math.max(1E-10,d.height)-i,border:i+"px solid "+f.color(e.color),zoom:1,position:"absolute"}),a=this.append(a,b,c);return a};var k=function(a){if(a&&a.type){this.originalEvent=a;this.type=a.type;this.isDefaultPrevented=o;if(a.defaultPrevented||a.returnValue===false||a.getPreventDefault&&
a.getPreventDefault())this.isDefaultPrevented=n}else this.type=a;this.timeStamp=Date.now()},n=function(){return true},o=function(){return false},p=["altKey","attrChange","attrName","bubbles","button","cancelable","charCode","clientX","clientY","ctrlKey","currentTarget","data","detail","eventPhase","fromElement","handler","keyCode","layerX","layerY","metaKey","newValue","offsetX","offsetY","pageX","pageY","prevValue","relatedNode","relatedTarget","screenX","screenY","shiftKey","srcElement","target",
"toElement","view","wheelDelta","which"];k.prototype={preventDefault:function(){this.isDefaultPrevented=n;var a=this.originalEvent;if(a)a.preventDefault?a.preventDefault():a.returnValue=false},stopPropagation:function(){this.isPropagationStopped=n;var a=this.originalEvent;if(a){a.stopPropagation&&a.stopPropagation();a.cancelBubble=true}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=n;this.stopPropagation()},isDefaultPrevented:o,isPropagationStopped:o,isImmediatePropagationStopped:o};
f.fixEvent=function(a){for(var b=a,a=new k(b),c=0,d=p.length;c<d;c++){var e=p[c];a[e]=b[e]}if(!a.target)a.target=a.srcElement||document;if(!a.relatedTarget&&a.fromElement)a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement;if(a.pageX==null&&a.clientX!=null){b=document.documentElement;c=document.body;a.pageX=a.clientX+(b&&b.scrollLeft||c&&c.scrollLeft||0)-(b&&b.clientLeft||c&&c.clientLeft||0);a.pageY=a.clientY+(b&&b.scrollTop||c&&c.scrollTop||0)-(b&&b.clientTop||c&&c.clientTop||0)}if(a.which==
null&&(a.charCode!=null||a.keyCode!=null))a.which=a.charCode!=null?a.charCode:a.keyCode;if(!a.metaKey&&a.ctrlKey)a.metaKey=a.ctrlKey;if(!a.which&&a.button!==void 0)a.which=a.button&1?1:a.button&2?3:a.button&4?2:0;if(a.type==="mousewheel")a.wheel=a.wheelDelta;return a};pv.listener=function(a){return a.$listener||(a.$listener=function(b){try{pv.event=f.fixEvent(b||window.event);return a.call(this,pv.event)}catch(c){pv.error(c)}finally{delete pv.event}})};pv.listen=function(a,b,c){c=pv.listener(c,a);
if(a===window)a=document.documentElement;return a.addEventListener?a.addEventListener(b,c,false):a.attachEvent("on"+b,c)};pv.VmlScene.dispatch=pv.listener(function(a){var b=a.target.$scene;b&&pv.Mark.dispatch(a.type,b.scenes,b.index)&&a.preventDefault()});pv.VmlScene.image=function(a){for(var b=a.$g.firstChild,c=0;c<a.length;c++){var d=a[c];if(d.visible){b=this.fill(b,a,c);if(!d.image){b=new Image;b.src=d.url;var e=b.style;e.position="absolute";e.top=d.top;e.left=d.left;e.width=d.width;e.height=d.height;
e.cursor=d.cursor;e.msInterpolationMode="bicubic"}b=this.append(b,a,c);b=this.stroke(b,a,c)}}return b};pv.VmlScene.label=function(a){for(var b=a.$g.firstChild,c=0;c<a.length;c++){var d=a[c];if(d.visible){var e=d.textStyle;if(e.opacity&&d.text){var i={};if(d.cursor)i.cursor=d.cursor;var h=d.text.replace(/\s+/g,"\u00a0"),j=f.text_dims(h,d.font),k=0,m=0;d.textBaseline==="middle"?m=m-j.fontsize/2:d.textBaseline==="top"?m=m+d.textMargin:d.textBaseline==="bottom"&&(m=m-(d.textMargin+j.fontsize));d.textAlign===
"center"?k=k-j.width/2:d.textAlign==="right"?k=k-(j.width+d.textMargin):d.textAlign==="left"&&(k=k+d.textMargin);b=this.expect(b,"text",i,{font:d.font,textDecoration:d.textDecoration,top:Math.round(d.top+m)+"px",left:Math.round(d.left+k)+"px",position:"absolute",display:"block",lineHeight:1,whiteSpace:"nowrap",zoom:1,cursor:"default",color:f.color(e.color)||"black"});b.innerText=h;if(d=180*d.textAngle/Math.PI){e=~~d%360*f.d2r;d=Math.cos(e);e=Math.sin(e);b.style.filter=["progid:DXImageTransform.Microsoft.Matrix(M11=",
d.toFixed(8),",M12=",-e.toFixed(8),",M21=",e.toFixed(8),",M22=",d.toFixed(8),",sizingMethod='auto expand')\";"].join("")}else b.style.filter="";b=this.append(b,a,c)}}}return b};pv.VmlScene.wedge=function(a){for(var b=a.$g.firstChild,c=f.round,d=0;d<a.length;d++){var e=a[d];if(e.visible){var i=e.fillStyle,h=e.strokeStyle;if(i.opacity||h.opacity){b=this.expect(b,"path",{"pointer-events":e.events,cursor:e.cursor,transform:"translate("+e.left+","+e.top+")",d:"",fill:i.color,"fill-rule":"evenodd","fill-opacity":i.opacity||
null,stroke:h.color,"stroke-opacity":h.opacity||null,"stroke-width":h.opacity?e.lineWidth/this.scale:null});i=b.getElementsByTagName("path")[0];if(!i){i=f.make("path");b.appendChild(i)}var h=c(e.innerRadius),j=c(e.outerRadius);if(e.angle>=2*Math.PI)e=h?"AE0,0 "+j+","+j+" 0 23592960AL0,0 "+h+","+h+" 0 23592960":"AE0,0 "+j+","+j+" 0 23592960";else var k=Math.round(e.startAngle/Math.PI*11796480),e=Math.round(e.angle/Math.PI*11796480),e=h?"AE 0,0 "+j+","+j+" "+-k+" "+-e+" 0,0 "+h+","+h+" "+-(k+e)+" "+
e+"X":"M0,0AE0,0 "+j+","+j+" "+-k+" "+-e+"X";i.v=e;b=this.append(b,a,d)}}}return b}}();
